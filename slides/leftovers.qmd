---
title: "Unused Slides from Other Chapters"
engine: knitr
---

# One-offs

## The Pieces of a URL

https://api.open.fec.gov/v1/candidates/?election_year=2020&office=P&api_key=DEMO_KEY

-   `https://api.open.fec.gov` = "scheme" + "host name"
-   `/v1/candidates/` = "path"
-   `?election_year=2020&office=P&api_key=DEMO_KEY` = "query"
-   *Not present:* 
    -   `:1234` = "port"
    -   `#target` = "fragment"
    -   `username:password@`

# tibblify::parse_openapi_spec()

## Endpoint info as data

-   {tibblify} can load OpenAPI endpoint data

```{r}
#| label: httr2-openfec-endpoints-download
#| eval: false
#| include: false
openfec_endpoints <- tibblify::parse_openapi_spec("https://api.apis.guru/v2/specs/fec.gov/1.0/openapi.json")
saveRDS(
  openfec_endpoints, 
  here::here("slides", "httr2", "openfec_endponts.rds")
)
```
```{r}
#| label: httr2-openfec-endpoints-load
#| eval: false
#| include: false
openfec_endpoints <- readRDS(
  here::here("slides", "httr2", "openfec_endponts.rds")
)
```

::: fragment
```{r}
#| label: httr2-openfec-endpoints-display
openfec_endpoints <- tibblify::parse_openapi_spec("https://api.apis.guru/v2/specs/fec.gov/1.0/openapi.json")
openfec_endpoints |> 
  unnest(operations)
```
```{r}
#| label: httr2-openfec-endpoints-print
#| eval: false
#| echo: false
openfec_endpoints |> 
  tidyr::unnest(operations) |> dplyr::select(
    endpoint, parameters, responses, description, tags, operation, dplyr::everything()
  )
```
:::

::: notes
-   This is a dev version of tibblify, production version only gets some of this data.
:::

## Endpoint parameters

```{r}
#| eval: false
candidates_endpoint <- openfec_endpoints |> 
  unnest(operations) |> 
  filter(endpoint == "/candidates/")
candidates_endpoint |> 
  select(parameters) |> 
  unnest(parameters)
```

## Endpoint responses

```{r}
#| eval: false
candidates_endpoint |> 
  select(responses) |>
  unnest(responses) |> 
  unnest(content)
```

::: notes
-   Note that `spec` is a tspec!
:::
